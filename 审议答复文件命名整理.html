<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®¡è®®ç­”å¤æ–‡ä»¶å‘½åæ•´ç†</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f1419;
      --surface: #1a2332;
      --surface-hover: #232f3f;
      --border: #2d3a4d;
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.15);
      --text: #e6edf3;
      --text-muted: #8b9eb5;
      --success: #22c55e;
      --success-soft: rgba(34, 197, 94, 0.12);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Noto Serif SC', 'Microsoft YaHei', serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 2rem 1rem;
      line-height: 1.6;
    }

    .container {
      max-width: 720px;
      margin: 0 auto;
    }

    h1 {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      letter-spacing: 0.02em;
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 0.95rem;
      margin-bottom: 2rem;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.25rem;
    }

    .card-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 0.75rem;
    }

    .upload-zone {
      border: 2px dashed var(--border);
      border-radius: 10px;
      padding: 1.5rem;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
      background: rgba(255,255,255,0.02);
    }

    .upload-zone:hover, .upload-zone.dragover {
      border-color: var(--accent);
      background: var(--accent-soft);
    }

    .upload-zone input[type="file"] {
      display: none;
    }

    .upload-zone .icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      opacity: 0.7;
    }

    .upload-zone .hint {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .extracted-name {
      font-family: 'JetBrains Mono', 'Consolas', monospace;
      font-size: 0.95rem;
      background: var(--success-soft);
      color: var(--success);
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      margin-top: 0.75rem;
      word-break: break-all;
    }

    .extracted-name.empty {
      background: transparent;
      color: var(--text-muted);
    }

    .extracted-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.75rem;
    }

    .extracted-row .extracted-name {
      margin-top: 0;
      flex: 1;
      min-width: 0;
    }

    .extracted-row:has(.empty) .copy-btn {
      visibility: hidden;
      pointer-events: none;
    }

    .name-field {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .name-field .label {
      color: var(--text-muted);
      font-size: 0.9rem;
      flex-shrink: 0;
    }

    .name-field input {
      font-family: inherit;
      font-size: 0.95rem;
      padding: 0.5rem 0.75rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--surface);
      color: var(--text);
      width: 140px;
    }

    .name-field input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .option-group {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .option-btn {
      font-family: inherit;
      font-size: 0.95rem;
      padding: 0.5rem 1rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--surface);
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    .option-btn:hover {
      border-color: var(--accent);
      background: var(--accent-soft);
    }

    .option-btn.active {
      border-color: var(--accent);
      background: var(--accent);
      color: #fff;
    }

    .name-list {
      list-style: none;
    }

    .name-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.6rem 0;
      border-bottom: 1px solid var(--border);
      font-size: 0.95rem;
    }

    .name-item:last-child {
      border-bottom: none;
    }

    .name-item .label {
      flex-shrink: 0;
      color: var(--text-muted);
      min-width: 140px;
    }

    .name-item .value {
      font-family: 'JetBrains Mono', 'Consolas', monospace;
      word-break: break-all;
      flex: 1;
    }

    .copy-btn {
      flex-shrink: 0;
      font-size: 0.8rem;
      padding: 0.25rem 0.5rem;
      border: 1px solid var(--border);
      border-radius: 4px;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }

    .copy-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .copy-btn.copied {
      border-color: var(--success);
      color: var(--success);
    }

    .placeholder {
      color: var(--text-muted);
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    @media (max-width: 600px) {
      .row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>å®¡è®®ç­”å¤æ–‡ä»¶å‘½åæ•´ç†</h1>
    <p class="subtitle">ä¸Šä¼ å®¡æŸ¥æ„è§é€šçŸ¥ä¹¦å’Œæœ¬ç”³è¯·æ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆè§„èŒƒçš„æ–‡ä»¶å‘½å</p>

    <div class="row">
      <div class="card">
        <div class="card-title">å®¡æŸ¥æ„è§é€šçŸ¥ä¹¦</div>
        <label class="upload-zone" id="zoneNotice">
          <input type="file" id="inputNotice" accept="*/*">
          <div class="icon">ğŸ“„</div>
          <div class="hint">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ </div>
          <div class="extracted-row">
            <div class="extracted-name empty" id="nameNotice">å°šæœªä¸Šä¼ </div>
            <button type="button" class="copy-btn copy-extracted" data-target="nameNotice">å¤åˆ¶</button>
          </div>
        </label>
      </div>

      <div class="card">
        <div class="card-title">æœ¬ç”³è¯·æ–‡ä»¶</div>
        <label class="upload-zone" id="zoneApp">
          <input type="file" id="inputApp" accept="*/*">
          <div class="icon">ğŸ“‹</div>
          <div class="hint">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ </div>
          <div class="extracted-row">
            <div class="extracted-name empty" id="nameApp">å°šæœªä¸Šä¼ </div>
            <button type="button" class="copy-btn copy-extracted" data-target="nameApp">å¤åˆ¶</button>
          </div>
        </label>
      </div>
    </div>

    <div class="card">
      <div class="name-field">
        <span class="label">å§“å</span>
        <input type="text" id="inputName" value="è‘£å¾·" placeholder="è‘£å¾·">
      </div>
      <div class="card-title">é€‰æ‹©å®¡æŸ¥è½®æ¬¡</div>
      <div class="option-group">
        <button type="button" class="option-btn active" data-value="1é€š">1é€š</button>
        <button type="button" class="option-btn" data-value="2é€š">2é€š</button>
        <button type="button" class="option-btn" data-value="3é€š">3é€š</button>
        <button type="button" class="option-btn" data-value="å¤å®¡">å¤å®¡</button>
      </div>

      <div class="card-title">ç”Ÿæˆçš„æ–‡ä»¶åç§°</div>
      <ul class="name-list">
        <li class="name-item">
          <span class="label">ç­”å¤æ–‡ä»¶åç§°</span>
          <span class="value" id="outReply"><span class="placeholder">â€”</span></span>
          <button type="button" class="copy-btn" data-target="outReply">å¤åˆ¶</button>
        </li>
        <li class="name-item">
          <span class="label">ä¿®æ”¹å¯¹ç…§é¡µåç§°</span>
          <span class="value" id="outCompare"><span class="placeholder">â€”</span></span>
          <button type="button" class="copy-btn" data-target="outCompare">å¤åˆ¶</button>
        </li>
        <li class="name-item">
          <span class="label">ä¿®æ”¹æ›¿æ¢é¡µåç§°</span>
          <span class="value" id="outReplace"><span class="placeholder">â€”</span></span>
          <button type="button" class="copy-btn" data-target="outReplace">å¤åˆ¶</button>
        </li>
        <li class="name-item">
          <span class="label">å¯¹æ¯”æ–‡ä»¶ç›´æ¥åœ¨ä¸‹è½½æ–‡ä»¶å‰åŠ å¯¹æ¯”æ–‡ä»¶1-ã€å¯¹æ¯”æ–‡ä»¶2-</span>
        </li>
        <li class="name-item">
          <span class="label">å‹ç¼©åŒ…åç§°</span>
          <span class="value" id="outZip"><span class="placeholder">â€”</span></span>
          <button type="button" class="copy-btn" data-target="outZip">å¤åˆ¶</button>
        </li>
        <li class="name-item">
          <span class="label">CPCåŒ…åç§°</span>
          <span class="value" id="outCpc"><span class="placeholder">â€”</span></span>
          <button type="button" class="copy-btn" data-target="outCpc">å¤åˆ¶</button>
        </li>
      </ul>
    </div>
  </div>

  <script>
    (function () {
      const inputNotice = document.getElementById('inputNotice');
      const inputApp = document.getElementById('inputApp');
      const nameNotice = document.getElementById('nameNotice');
      const nameApp = document.getElementById('nameApp');
      const zoneNotice = document.getElementById('zoneNotice');
      const zoneApp = document.getElementById('zoneApp');
      const optionBtns = document.querySelectorAll('.option-btn[data-value]');
      const inputName = document.getElementById('inputName');

      let noticeFileName = '';
      let appBaseName = '';
      let appDisplayName = '';
      let selectedTong = '1é€š';

      function getBaseName(path) {
        if (!path) return '';
        const name = path.replace(/^.*[\\/]/, '');
        const dot = name.lastIndexOf('.');
        return dot > 0 ? name.slice(0, dot) : name;
      }

      function todayStr() {
        const d = new Date();
        const y = d.getFullYear();
        const m = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        return y + m + day;
      }

      function updateNotice(ev) {
        const f = (ev.target && ev.target.files && ev.target.files[0]) || (ev.dataTransfer && ev.dataTransfer.files[0]);
        if (!f) return;
        noticeFileName = f.name;
        nameNotice.textContent = getBaseName(noticeFileName);
        nameNotice.classList.remove('empty');
        updateOutputs();
      }

      function updateApp(ev) {
        const f = (ev.target && ev.target.files && ev.target.files[0]) || (ev.dataTransfer && ev.dataTransfer.files[0]);
        if (!f) return;
        appBaseName = getBaseName(f.name);
        appDisplayName = 'æœ¬ç”³è¯·-' + appBaseName;
        nameApp.textContent = appDisplayName;
        nameApp.classList.remove('empty');
        updateOutputs();
      }

      function setTong(val) {
        selectedTong = val;
        optionBtns.forEach(function (b) {
          b.classList.toggle('active', b.getAttribute('data-value') === val);
        });
        updateOutputs();
      }

      function getUserName() {
        const el = document.getElementById('inputName');
        return (el && el.value && el.value.trim()) ? el.value.trim() : 'è‘£å¾·';
      }

      function updateOutputs() {
        const A = appBaseName || 'A';
        const noticeBase = noticeFileName ? getBaseName(noticeFileName) : '';
        const date = todayStr();
        const userName = getUserName();

        setOut('outReply', selectedTong + 'ç­”å¤æ–‡ä»¶-' + A);
        setOut('outCompare', selectedTong + 'æƒåˆ©è¦æ±‚ä¹¦-ä¿®æ”¹å¯¹ç…§é¡µ-' + A);
        setOut('outReplace', selectedTong + 'æƒåˆ©è¦æ±‚ä¹¦-ä¿®æ”¹æ›¿æ¢é¡µ-' + A);
        setOut('outZip', (noticeBase || 'å®¡æŸ¥æ„è§é€šçŸ¥ä¹¦') + '-' + userName + '-' + date);
        setOut('outCpc', selectedTong + '-CPCåŒ…-' + A);
      }

      function setOut(id, text) {
        const el = document.getElementById(id);
        if (!el) return;
        const ph = el.querySelector('.placeholder');
        if (ph) {
          ph.remove();
        }
        el.textContent = text;
      }

      function setupDragDrop(zone, handler) {
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(function (e) {
          zone.addEventListener(e, function (ev) {
            ev.preventDefault();
            ev.stopPropagation();
            zone.classList.toggle('dragover', e === 'dragenter' || e === 'dragover');
            if (e === 'drop' && ev.dataTransfer && ev.dataTransfer.files.length) {
              handler({ dataTransfer: ev.dataTransfer });
            }
          });
        });
      }

      inputNotice.addEventListener('change', updateNotice);
      inputApp.addEventListener('change', updateApp);
      setupDragDrop(zoneNotice, function (ev) {
        const f = ev.dataTransfer.files[0];
        if (!f) return;
        noticeFileName = f.name;
        nameNotice.textContent = getBaseName(noticeFileName);
        nameNotice.classList.remove('empty');
        updateOutputs();
      });
      setupDragDrop(zoneApp, function (ev) {
        const f = ev.dataTransfer.files[0];
        if (!f) return;
        appBaseName = getBaseName(f.name);
        appDisplayName = 'æœ¬ç”³è¯·-' + appBaseName;
        nameApp.textContent = appDisplayName;
        nameApp.classList.remove('empty');
        updateOutputs();
      });

      if (inputName) {
        inputName.addEventListener('input', updateOutputs);
        inputName.addEventListener('change', updateOutputs);
      }

      optionBtns.forEach(function (b) {
        b.addEventListener('click', function () {
          setTong(b.getAttribute('data-value'));
        });
      });

      function doCopy(btn, text) {
        if (!text || text === 'â€”' || text === 'å°šæœªä¸Šä¼ ') return;
        navigator.clipboard.writeText(text).then(function () {
          btn.textContent = 'å·²å¤åˆ¶';
          btn.classList.add('copied');
          setTimeout(function () {
            btn.textContent = 'å¤åˆ¶';
            btn.classList.remove('copied');
          }, 1500);
        });
      }

      document.querySelectorAll('.copy-btn.copy-extracted').forEach(function (btn) {
        btn.addEventListener('click', function (ev) {
          ev.preventDefault();
          ev.stopPropagation();
          const id = btn.getAttribute('data-target');
          const el = document.getElementById(id);
          const text = el && el.textContent ? el.textContent.trim() : '';
          doCopy(btn, text);
        });
      });

      document.querySelectorAll('.copy-btn:not(.copy-extracted)').forEach(function (btn) {
        btn.addEventListener('click', function () {
          const id = btn.getAttribute('data-target');
          const el = document.getElementById(id);
          const text = el && el.textContent ? el.textContent.trim() : '';
          doCopy(btn, text);
        });
      });

      updateOutputs();
    })();
  </script>
</body>
</html>
